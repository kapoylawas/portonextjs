"use strict";const i=require("./jsx-runtime.cjs"),a=require("react"),l=require("./config.cjs"),b=require("@vavt/util"),P=(e,u)=>{const s=o=>{const d=e.parentElement||document.body,f=d.offsetWidth,m=d.offsetHeight,x=document.documentElement.clientWidth,v=document.documentElement.clientHeight,h=o.offsetX,y=o.offsetY,r=t=>{let n=t.x+document.body.scrollLeft-document.body.clientLeft-h,c=t.y+document.body.scrollTop-document.body.clientTop-y;n=n<1?1:n<x-f-1?n:x-f-1,c=c<1?1:c<v-m-1?c:v-m-1,u?u(n,c):(d.style.left=n+"px",d.style.top=c+"px")};document.addEventListener("mousemove",r);const E=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",E)};document.addEventListener("mouseup",E)};return e.addEventListener("mousedown",s),()=>{e.removeEventListener("mousedown",s)}},C=(e,u="")=>{const s=document.getElementById(e.id),o=e.onload;e.onload=null;const d=function(f){typeof o=="function"&&o.bind(this)(f),e.removeEventListener("load",d)};s?u!==""&&(s.addEventListener("load",d),Reflect.get(window,u)&&s.dispatchEvent(new Event("load"))):(e.addEventListener("load",d),document.head.appendChild(e))},$=b.debounce((e,u,s)=>{const o=document.getElementById(e);o&&o.setAttribute(u,s)},10),j=e=>{const{onClose:u=()=>{}}=e,[s,o]=a.useState(e.visible),[d,f]=a.useState([`${l.prefix}-modal`]),m=a.useRef(null),x=a.useRef(null),[v,h]=a.useState({initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),y=a.useMemo(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height},[e.height,e.isFullscreen,e.width]),[r,E]=a.useState(!1);return a.useEffect(()=>{let t=()=>{};return e.isFullscreen||(t=P(x.current,(n,c)=>{h(g=>({...g,initPos:{left:n+"px",top:c+"px"}}))})),t},[r,e.isFullscreen]),a.useEffect(()=>{if(s){const t=m.current.offsetWidth/2,n=m.current.offsetHeight/2,c=document.documentElement.clientWidth/2,g=document.documentElement.clientHeight/2;h(H=>({...H,initPos:{left:c-t+"px",top:g-n+"px"}})),!r&&E(!0)}},[r,s]),a.useEffect(()=>{const t=e.visible;t?(f(()=>[`${l.prefix}-modal`,"zoom-in"]),o(t)):r&&(f(()=>[`${l.prefix}-modal`,"zoom-out"]),setTimeout(()=>{o(t)},150))},[r,e.visible]),i.jsxs("div",{className:e.className,style:{display:s?"block":"none"},children:[i.jsx("div",{className:`${l.prefix}-modal-mask`,onClick:u}),i.jsxs("div",{className:d.join(" "),style:{...v.initPos,...y},ref:m,children:[i.jsx("div",{className:`${l.prefix}-modal-header`,ref:x,children:e.title||""}),i.jsxs("div",{className:`${l.prefix}-modal-func`,children:[e.showAdjust&&i.jsx("div",{className:`${l.prefix}-modal-adjust`,onClick:t=>{t.stopPropagation(),e.isFullscreen?h(n=>({...n,initPos:n.historyPos})):h(n=>({historyPos:n.initPos,initPos:{left:"0",top:"0"}})),e.onAdjust instanceof Function&&e.onAdjust(!e.isFullscreen)},children:i.jsx("svg",{className:`${l.prefix}-icon`,"aria-hidden":"true",children:i.jsx("use",{xlinkHref:`#md-editor-icon-${e.isFullscreen?"suoxiao":"fangda"}`})})}),i.jsx("div",{className:`${l.prefix}-modal-close`,onClick:t=>{t.stopPropagation(),e.onClose&&e.onClose()},children:i.jsx("svg",{className:`${l.prefix}-icon`,"aria-hidden":"true",children:i.jsx("use",{xlinkHref:"#md-editor-icon-close"})})})]}),i.jsx("div",{className:`${l.prefix}-modal-body`,children:e.children})]})]})};j.defaultProps={onAdjust(){}};exports.Modal=j;exports.appendHandler=C;exports.updateHandler=$;
